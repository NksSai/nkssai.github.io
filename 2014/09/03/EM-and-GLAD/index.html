<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>EM与GLAD | 今天拒绝负能量</title>
  <meta name="description" content="" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" type="text/css" href="/css/component.css" />
  <link rel="stylesheet" type="text/css" href="/css/screen.css" />
  <meta name="generator" content="今天拒绝负能量">
  <script src="http://static.duoshuo.com/embed.js"></script>
  
  
  

  

</head>
<body>
<div class="container">
    <div class="mp-pusher" id="mp-pusher">
        <i id="scroll-up" class="fa fa-angle-up"></i>
        <nav id="mp-menu" class="mp-menu">
            <div class="mp-level">
                <a data-pjax class="back-home" style="font-size: 20px" href="/"><h2 ><i class="fa fa-home"></i>
                        Home</h2></a>
                <ul class="first-level">
                    <li>
                        <a class="fa fa-archive" href="#"><i class="fa fa-angle-left">
                            </i>&nbsp;&nbsp;归档</a>
                        <div class="mp-level page-list">
                            <h2 ><i class="fa fa-archive"></i>
                                归档</h2>
                            <a class="mp-back" href="#">back</a>
                            <form id="search-form" action="">
                                <input type="text" class="search search-archive" placeholder="Search.."/>
                            </form>
                            <ul>
                                <div class="mp-scroll">
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/09/30/Gibbs-Sampling-and-B-LDA/">Gibbs Sampling与B-LDA</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/09/13/VB-and-LDA/">变分推断与LDA</a>
                                </li>
                                
                                <li class="search-archive-li mp-pjax">
                                    <a href="/2014/09/03/EM-and-GLAD/">EM与GLAD</a>
                                </li>
                                
                                </div>
                            </ul>
                        </div>
                    </li>
                    <li>
                        <a class="fa fa-copy" href="#"><i class="fa fa-angle-left">
                            </i>&nbsp;&nbsp;分类</a>

                        <div class="mp-level page-list">
                            <h2 ><i class="fa fa-copy"></i>
                                分类</h2>
                            <a class="mp-back" href="#">back</a>
                            <form id="search-form" action="">
                                <input type="text" class="search search-category" placeholder="Search.."/>
                            </form>
                            <ul>
                                <div class="mp-scroll">
                                
                                <li class="search-category-li mp-pjax">
                                    <a href="/categories/正经笔记/">&nbsp;&nbsp;&nbsp;正经笔记</a>
                                    <small>2</small>
                                </li>
                                
                                </div>
                            </ul>
                        </div>
                    </li>
                    <li>
                        <a class="fa fa-tags" href="#"><i class="fa fa-angle-left">
                            </i>&nbsp;&nbsp;标签</a>
                        <div class="mp-level page-list">
                            <h2 ><i class="fa fa-tags"></i>
                                标签</h2>
                            <a class="mp-back" href="#">back</a>
                            <form id="search-form" action="">
                                <input type="text" class="search search-tag" placeholder="Search.."/>
                            </form>
                            <ul>
                                <div class="mp-scroll">
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/Crowdsourcing/">&nbsp;&nbsp;&nbsp;Crowdsourcing</a>
                                    <small>1</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/EM/">&nbsp;&nbsp;&nbsp;EM</a>
                                    <small>1</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/GLAD/">&nbsp;&nbsp;&nbsp;GLAD</a>
                                    <small>1</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/LDA/">&nbsp;&nbsp;&nbsp;LDA</a>
                                    <small>2</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/MCMC/">&nbsp;&nbsp;&nbsp;MCMC</a>
                                    <small>1</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/PGM/">&nbsp;&nbsp;&nbsp;PGM</a>
                                    <small>1</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/Sampling/">&nbsp;&nbsp;&nbsp;Sampling</a>
                                    <small>1</small>
                                </li>
                                
                                <li class="search-tag-li mp-pjax">
                                    <a href="/tags/Variational-Bayes/">&nbsp;&nbsp;&nbsp;Variational-Bayes</a>
                                    <small>1</small>
                                </li>
                                
                                </div>
                            </ul>
                        </div>
                    </li>
                    
                    <li class="mp-pjax"><a class="fa fa-user" href="/about">&nbsp;&nbsp;&nbsp;About me</a></li>
                    <li><a class="fa fa-github" href="#">&nbsp;&nbsp;&nbsp;Github</a></li>

                </ul>

            </div>
        </nav>
        <div id="pjax">
            <div class="pjax-hidden" style="display: none">
                
                    <a  data-pjax href="/2014/09/30/Gibbs-Sampling-and-B-LDA/">Gibbs Sampling与B-LDA</a>
                
                    <a  data-pjax href="/2014/09/13/VB-and-LDA/">变分推断与LDA</a>
                
                    <a  data-pjax href="/2014/09/03/EM-and-GLAD/">EM与GLAD</a>
                
                
                    <a data-pjax href="/categories/正经笔记/">&nbsp;&nbsp;正经笔记</a>
                
                
                    <a data-pjax href="/tags/Crowdsourcing/">&nbsp;&nbsp;Crowdsourcing</a>
                
                    <a data-pjax href="/tags/EM/">&nbsp;&nbsp;EM</a>
                
                    <a data-pjax href="/tags/GLAD/">&nbsp;&nbsp;GLAD</a>
                
                    <a data-pjax href="/tags/LDA/">&nbsp;&nbsp;LDA</a>
                
                    <a data-pjax href="/tags/MCMC/">&nbsp;&nbsp;MCMC</a>
                
                    <a data-pjax href="/tags/PGM/">&nbsp;&nbsp;PGM</a>
                
                    <a data-pjax href="/tags/Sampling/">&nbsp;&nbsp;Sampling</a>
                
                    <a data-pjax href="/tags/Variational-Bayes/">&nbsp;&nbsp;Variational-Bayes</a>
                
                <a data-pjax class="fa fa-user" href="/about">&nbsp;&nbsp;&nbsp;About me</a>
            </div>
            <nav class="nexus">
                <li  style="border-left: 1px solid #c6d0da;">
                    <a id="trigger" href="#"><i class="fa fa-bars"></i></a>
                </li>
                <li ><a id="nexus-back" data-pjax href="/">今天拒绝负能量</a></li>
                
                <div id="nav-container">
                    <div class="post-navbar" style="line-height: 63px;display:none">
                        <li id="navbar-title"><a href="#">EM与GLAD</a></li>
                        <li id="navbar-toc" style="border-left: none">
                            <a style="padding-right: 15px">
                                <span id="toc-content" >Introduction</span><i class="fa fa-chevron-down" ></i>
                            </a>
                            <div class="hidden-box">
                                <ul id="toc"></ul>
                            </div>
                        </li>
                    </div>
                </div>
                
            </nav>

            <div class="scroller">
            <div class="scroller-inner">


<!-- -->
<!--<body class="post-template">-->
<!---->
  

<main class="content" role="main">
    <article class="post" >
    <span class="post-meta">
                  <div class="tag-tile">
                      
                      
                      <a data-pjax href='/tags/EM/' style='color:#D5D5D5'>EM</a>
                      
                      <a data-pjax href='/tags/Crowdsourcing/' style='color:#D5D5D5'>Crowdsourcing</a>
                      
                      <a data-pjax href='/tags/GLAD/' style='color:#D5D5D5'>GLAD</a>
                      
                      
                  </div>
                <h1 class="post-title" style="margin: 14px 0;color:#50585D">EM与GLAD</h1>

                    <div class="post-meta">
                        Post on<span class="fa fa-clock-o"></span>
                        <time datetime="2014-09-02T16:00:00.000Z"
                              itemprop="datePublished">Sep 3 2014</time>
                    </div>
    </span>

        <section class="post-content">
            <p><strong>GLAD</strong>是<code>Jacob Whitehill</code>在2009年NIPS上提出了一个算法，其本质只是采用简化的<code>Item Response Theory</code>中的模型，利用EM算法求解隐含变量，得到题目正确的答案。 <a id="more"></a></p>
<p>先介绍<strong>GLAD</strong>要解决的问题，在处理多人图片标注数据时，只采用<code>Majority Vote</code>即认为大多数人选择的答案就是正确答案的方式在题目难度较大时并不能得到好的结果。所以采用Rasch模型来表示每个人回答正确的能力，以正确答案为隐含变量。</p>
<p>形式化的定义这个问题，首先假设要处理的问题为<code>Y/N</code>的二值问题，存在<span class="math">\(N\)</span>个题目，第<span class="math">\(j\)</span>个题目正确答案为<span class="math">\(z_j\)</span>，存在<span class="math">\(M\)</span>个工作者，然后我们采用如下形式定义一个第<span class="math">\(i\)</span>个工作者答对第<span class="math">\(j\)</span>个题目的标记答案为<span class="math">\(L_{ij}\)</span>,其正确的概率为： <span class="math">\[p(L_{ij}=Z_j|\alpha_i,\beta_j) = \dfrac{1}{1+e^{-\alpha_i\beta_j}}\]</span></p>
<p>其中<span class="math">\(\alpha_i\)</span>为第i个工作者的能力其范围为<span class="math">\((-\infty,+\infty)\)</span>，而<span class="math">\(1/\beta_j\)</span>为第j个题目的难度其范围为<span class="math">\([0,\infty)\)</span>。 图模型为： <img src="./GLAD.png" alt="Alt text"> 我们观测到的标签是由真实标签在通过工作者判断函数后得到的结果，其中真实标签正是我们想要求的隐藏变量，其对数似然应该为 <span class="math">\[p(L|\alpha,\beta)=\sum_i^M{\sum_j^N{\ln\{\sum_l^Kp(z_{l})p(L|\alpha,\beta,z_l)\}}}\]</span> 像常见的高斯混合模型一样，由于隐藏变量作为指示变量存在导致我们在直接使用极大似然的时候容易获得由于<span class="math">\(p(z_l)\)</span>趋向于<span class="math">\(\infty\)</span>而产生的极大值，这显然不是我们愿意见到的情况，何况<span class="math">\(z_j\)</span>的值是我们想要得到的信息。所以我们采用EM算法来解决这个问题。 我们之前遇到的问题是在隐藏变量存在的情况下，我们难以直接极大化似然，我们能不能换种方法直接极大化似然呢？ 我们用<span class="math">\(X\)</span>表示观察到变量，<span class="math">\(Z\)</span>表示隐藏变量，而<span class="math">\(\theta\)</span>表示参数，则我们想极大化的似然为 <span class="math">\[p(X|\theta)=\sum_{Z}p(X,Z|\theta)\]</span> 我们先放弃直接优化，利用贝叶斯公式变形，取对数似然.由 <span class="math">\[\ln p(X,Z|\theta)=\ln p(Z|X,\theta)+\ln p(X|\theta)\]</span> 得 <span class="math">\[\ln p(X|\theta)=\ln p(X,Z|\theta)-\ln p(Z|X,\theta)\]</span> 然后我们取一个关于<span class="math">\(Z\)</span>分布<span class="math">\(q(Z)\)</span>，注意这里我们并不关心<span class="math">\(q(Z)\)</span>是什么样子，而不对它做任何假设。则上面的式子可以变成 <span class="math">\[\begin{split}\ln p(X|\theta)=&amp; \ln p(X,Z|\theta)-\ln p(Z|X,\theta) \\=&amp;\ln p(X,Z|\theta)-\ln q(Z)-[\ln p(Z|X,\theta)-\ln q(Z)]\\=&amp; \ln \frac{ p(X,Z|\theta)}{q(Z)}-\ln \frac{ p(Z|X,\theta)}{q(Z)} \\\end{split}\]</span></p>
<p>由于<span class="math">\(q(Z)\)</span>是关于<span class="math">\(Z\)</span>的分布所以应该有<span class="math">\(\sum_Z q(Z)=1\)</span>,而且<span class="math">\(Z\)</span>与已经将<span class="math">\(Z\)</span>积分掉的<span class="math">\(p(x|\theta)\)</span>独立，所以我们可以继续将上式先乘以<span class="math">\(q(Z)\)</span>然后对<span class="math">\(Z\)</span>求和。 <span class="math">\[\sum_{z}q(Z) \ln p(X|\theta)=\sum_{z}[q(Z)(\ln \frac{ p(X,Z|\theta)}{q(Z)}-\ln \frac{ p(Z|X,\theta)}{q(Z)})]\]</span> <span class="math">\[\ln p(X|\theta)=\sum_{z}q(Z)\ln \frac{ p(X,Z|\theta)}{q(Z)}-\sum_{z}q(Z)\ln \frac{ p(Z|X,\theta)}{q(Z)}\]</span> 即</p>
<p><span class="math">\[\ln p(X|\theta)=\mathcal{L}(q,\theta)+KL(q||p)\]</span></p>
<p>其中</p>
<p><span class="math">\[\mathcal{L}(q,\theta)=\sum_{z}q(Z)\ln \frac{ p(X,Z|\theta)}{q(Z)}\]</span> <span class="math">\[KL(q||p)=\sum_{z}q(Z)\ln \frac{ q(Z)}{p(Z|X,\theta)}\]</span></p>
<p>(很多推断算法中都有这个式子的身影) 现在再看这个式子，先看KL散度的部分，它描述了分布<span class="math">\(q(Z)\)</span>和<span class="math">\(p(X,Z|\theta)\)</span>的差距，如果当<span class="math">\(q(Z)\)</span>与<span class="math">\(P(Z|X,\theta)\)</span>像相似，我们不妨用<span class="math">\(P(Z|X,\theta)\)</span>来替换<span class="math">\(q(Z)\)</span>,为了区分我们把替换的分布写成<span class="math">\(p(Z|X,\theta^{old})\)</span>，于是我们可以把<span class="math">\(\mathcal{L}(q,\theta)\)</span>写成</p>
<p><span class="math">\[\mathcal{L}(q,\theta) = \mathcal{Q}(\theta,\theta^{old})+const\]</span></p>
<p>其中</p>
<p><span class="math">\[\begin{split} \mathcal{Q}(\theta,\theta^{old}) = &amp;\sum_zp(Z|X,\theta^{old})\ln p(X,Z|\theta)\\=&amp;E_z[\ln p(X,Z|\theta)]\end{split}\]</span> 这里<span class="math">\(E_Z[\ln p(X,Z|\theta)]是指在分布\)</span>q(Z)下<span class="math">\(\ln p(X,Z|\theta)\)</span>值的期望。 由于后面的一项只和<span class="math">\(q(Z)\)</span>有关所以置换为 <span class="math">\[const=-\sum_Zp(Z|X,\theta^{old})\ln p(Z|X,\theta^{old})\]</span></p>
<p>这里我们似乎找到了一种在分布<span class="math">\(q(Z)\)</span>和<span class="math">\(p(X,Z|\theta)\)</span>很小的情况下，利用<span class="math">\(\mathcal{L}(q,\theta)\)</span>（本质上是利用<span class="math">\(\mathcal{Q}(\theta,\theta^{old})\)</span>或者说<span class="math">\(E_z[\ln p(X,Z|\theta)]\)</span>）接近真实<span class="math">\(\ln p(X|\theta)\)</span>的方法。现在还差如何尽量减少<span class="math">\(KL(q||p)\)</span>的部分了。考虑到上面我们想到了固定<span class="math">\(Z\)</span>优化<span class="math">\(\theta\)</span>的方面，优化<span class="math">\(KL(q||p)\)</span>的过程其实就是固定<span class="math">\(\theta\)</span>优化<span class="math">\(Z\)</span>，由于KL散度的形式，其实就是优化<span class="math">\(p(Z|X,\theta)\)</span>，我们很高兴的发现这次问题简单了很多，由于我们处理的数据中<span class="math">\(X\)</span>中往往是包含独立同分布的<span class="math">\(\{x_n\}\)</span>，以及相互独立的指示变量<span class="math">\(\{z_n\}\)</span>，所以显然 <span class="math">\[p(Z|X,\theta)=\frac{p(X|Z,\theta)}{\sum_Zp(X,Z|\theta)}=\frac{\prod_{n=1}^{N}p(x_n,z_n|\theta)}{\sum_Z\prod_{n=1}^{N}p(x_n,z_n|\theta)}=\prod^N_{n=1}p(z_n|x_n,\theta)\]</span></p>
<p>即为了优化KL散度，我们只要让<span class="math">\(z_n\)</span>取在给定<span class="math">\(\theta,x_n\)</span>下的最优值就好了。</p>
<p>至此，需要优化的参数都存在循环依赖，我们只要分步迭代优化就好了，这就是所谓的Expectation Maximization（期望极大化）算法。 （这里采用一个不怎么合理的顺序介绍了EM算法的原理与推导，我也不知道发明算法的是怎么发现这种方法的，不过这是我认为最好理解的顺序）</p>
<p>总结一下，所谓的EM（Expectation Maximization）算法， E步：在给定<span class="math">\(\theta\)</span>的情况下，求得最优的<span class="math">\(\{z_n\}\)</span>，以求得<span class="math">\(E_z[\ln p(X,Z|\theta)]\)</span>。本质上也是减少KL的过程。 M步：优化<span class="math">\(\theta\)</span>，用来极大化期望<span class="math">\(E_z[\ln p(X,Z|\theta)]\)</span>，即极大化<span class="math">\(\mathcal{L}(q,\theta)\)</span>的过程。 《PRML》中的图很好的解释了这个过程。</p>
<p>开始</p>
<div class="figure">
<img src="./GLAD-init.png" alt="Alt text"><p class="caption">Alt text</p>
</div>
<p>E步</p>
<div class="figure">
<img src="./GLAD-E.png" alt="Alt text"><p class="caption">Alt text</p>
</div>
<p>M步</p>
<div class="figure">
<img src="./GLAD-M.png" alt="Alt text"><p class="caption">Alt text</p>
</div>
<p>了解了EM的原理，我们回到GLAD模型的求解问题，有了EM，求解GLAD模型变得十分简单， 在E步，我们要求解每一个<span class="math">\(p(z_j|l,\alpha,\beta)\)</span>，由于每个<span class="math">\(\{z_j\}\)</span>都是独立的，采用贝叶斯公式变形，则有 <span class="math">\[\begin{split}p(z_j|l,\alpha,\beta)=&amp;p(z_j|l_j,\alpha,\beta_j) \\ \propto &amp;p(z_j|\alpha,\beta_j)p(l_j|z_j,\alpha,\beta_j)\\ \propto&amp;p(z_j)\prod_ip(l_{ij}|z_j,\alpha_i,\beta_j)\end{split}\]</span></p>
<p>我们在式子中省略了归一化的项。这里也可以看出<span class="math">\(z_j\)</span>的值是所有完成第<span class="math">\(j\)</span>题的人的选项的在每个人作对概率上的期望。这也符合E步的意义。</p>
<p>在M步中，对于<span class="math">\(Q\)</span>函数，有 <span class="math">\[\begin{split}Q(\alpha,\beta)=&amp;E[\ln p(l,z|\alpha,\beta)]\\ =&amp; E[\ln\prod_j(p(z_j)\prod_i\ln p(l_{ij}|z_j,\alpha_i,\beta_j))] \\=&amp;\sum_jE[\ln p(z_j)]+\sum_{ij}E[\ln p(l_{ij}|z_j,\alpha_i,\beta_j)] \end{split}\]</span></p>
<p>现在第一项与<span class="math">\(\alpha,\beta\)</span>无关，不是我们关心的，我们只要将最后一项展开，然后利用梯度下降的方法求得最优值就好了。</p>
<p>至此，我们了解了EM算法以及GLAD模型的求解方法。</p>
<p>针对GLAD模型，这是一个相当简单的假设，尤其是那个用户判断正确的模型十分实用，在很多复杂的模型中都使用过，但是GLAD模型在面对多分类的情况显得有些乏力，如果假设工作者在面对非正确答案时采取相同的概率选择答案，这样的假设显然并不合理，如果在不同选项中都加入相应的权值参数以改进效果，会导致参数个数随着工作者与答案选项个数增加的速度太快，这显然不是我们想见到的，所以这种情况下还有另外的建模方式，所谓的confuse matrix。</p>
<p>针对EM算法，还有一些有用的地方。</p>
<p>首先，一开始我们就指出我们要优化的是对数似然，其实在很多时候我们想要采用MAP（极大后验概率）的方式，即： <span class="math">\[\begin{split}\ln p(\theta|X) =&amp; \ln p(\theta,X)-\ln p(X) \\
=&amp;\mathcal{L}(q,\theta)+KL(q||p)-\ln p(X)\end{split}\]</span></p>
<p>其中<span class="math">\(\ln p(X)\)</span>常数，考虑到<span class="math">\(q\)</span>其实只在<span class="math">\(\mathcal{L}\)</span>中存在，所以在E步上来说，MAP并没有很大的不同，M步由于存在<span class="math">\(\ln p(\theta)\)</span>，所以和普通EM差距也不大，实际在GLAD的也好像只是多了一个乘数项（很久之前推的，当时的推导找不到了，反正换成MAP之后，在它数据集上的效果基本没有提高）。</p>
<p>另外一方面，我们意识到EM其实就是在E、M两个步骤分布优化的过程，普通的EM算法希望在M步中获取<span class="math">\(\mathcal{L}\)</span>的极大值，在<span class="math">\(\mathcal{L}\)</span>很复杂的时候，我们难以直接求最优解，此时，我们可以放弃求最优解，转而求较优解，甚至是将参数再分为几个子集，每一次M步骤中分别优化不同的子集，总之，只要我们保证每次迭代之后<span class="math">\(\mathcal{L}\)</span>都比开始接近似然就可以保证整体可以取得更优解。 于此相似的，E步我们也可以采用相似的策略，由于显然在<span class="math">\(mathcal{L}\)</span>取得局部最优解的情况下，<span class="math">\(\ln p(X|\theta)\)</span>显然也应该处于局部最优解，所以我们显然可以将数据集<span class="math">\({x_n}\)</span>分组，采用类似于随机梯度下降的方式迭代EM算法，尤其是在分布本身是指数家族的时候，在M步需要所有数据点的信息时，由于其分布可以通过充分统计量还原，仅仅采用充分统计量迭代往往有着更简单的形式。</p>

        </section>
        <hr/>
        <nav class="pagination" style="width:auto" role="pagination">
            
            <a data-pjax class="newer-posts" href="/2014/09/13/VB-and-LDA/">← Prev Post</a>
            
            <a class="share-button" data-original-title title>Share this Post</a>
            
        </nav>
        <br/>
        <br/>
        <section id="comment">
            <div id="comment-box"></div>
        </section>


    </article>
</main>


  
<footer class="site-footer">
    
    <div class="inner">
        <section class="copyright"><a href="/"></a> &copy; 今天拒绝负能量 2014</section>
        <section class="poweredby">Published with <a target="_blank" href="http://hexo.io/">Hexo   </a> and Theme by <a target="_blank" href="https://github.com/yuche/hexo-theme-kael">Kael</a></section>
    </div>
</footer>
</div>
</div><!-- /scroller -->

</div><!-- /pusher -->
</div><!-- /container -->
</div>

<!-- Easter eggs -->

<div class="egg animated">
    <a id="close-button" href="#">X</a>
    <div class="block">
        <div class="loading">
            <span class="ball1"></span>
            <span class="ball2"></span>
        </div>
    </div>
</div>
  
<script src="//cdn.staticfile.org/jquery/1.11.0/jquery.min.js"></script>
<script>
    if (!window.jQuery) {
        var script = document.createElement('script');
        script.src = "/js/jquery.min.js";
        document.body.appendChild(script);
    }
</script>
<script type="text/javascript" src="/js/lib.js"></script>
<script type="text/javascript" src="/js/main.js"></script>





<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<script type="text/x-mathjax-config">
$(document).on('pjax:end', function(){
MathJax.Hub.Typeset();
})
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



</body>
</html>
